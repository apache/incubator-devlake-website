"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[20368],{99481:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>u});var n=a(87462),l=(a(67294),a(3905));a(61839);const o={title:"Environment Variables",sidebar_position:6,description:"How to set up environment variables for DevLake"},i=void 0,r={unversionedId:"GettingStarted/Environment",id:"GettingStarted/Environment",title:"Environment Variables",description:"How to set up environment variables for DevLake",source:"@site/docs/GettingStarted/Environment.md",sourceDirName:"GettingStarted",slug:"/GettingStarted/Environment",permalink:"/zh/docs/GettingStarted/Environment",draft:!1,editUrl:"https://github.com/apache/incubator-devlake-website/edit/main/docs/GettingStarted/Environment.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Environment Variables",sidebar_position:6,description:"How to set up environment variables for DevLake"},sidebar:"docsSidebar",previous:{title:"Security and Authentication",permalink:"/zh/docs/GettingStarted/Authentication"},next:{title:"Config UI",permalink:"/zh/docs/Config UI"}},s={},u=[{value:"Environment Variables",id:"environment-variables",level:2},{value:"ENABLE_SUBTASKS_BY_DEFAULT",id:"enable_subtasks_by_default",level:3},{value:"How to set",id:"how-to-set",level:4},{value:"GITHUB_GRAPHQL_JOB_...",id:"github_graphql_job_",level:3},{value:"When to Use",id:"when-to-use",level:4},{value:"How to take effect",id:"how-to-take-effect",level:2}],m={toc:u};function p(e){let{components:t,...a}=e;return(0,l.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This document explains how to set environment variables for Apache DevLake and what environment variables can be set."),(0,l.kt)("h2",{id:"environment-variables"},"Environment Variables"),(0,l.kt)("h3",{id:"enable_subtasks_by_default"},"ENABLE_SUBTASKS_BY_DEFAULT"),(0,l.kt)("p",null,"This environment variable is used to enable or disable the execution of subtasks."),(0,l.kt)("h4",{id:"how-to-set"},"How to set"),(0,l.kt)("p",null,"The format is as follows: plugin_name1:subtask_name1:enabled_value,plugin_name2:subtask_name2:enabled_value,plugin_name3:subtask_name3:enabled_value"),(0,l.kt)("p",null,"Guidance on locating the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/incubator-devlake/blob/release-v1.0/backend/plugins/jira/tasks/issue_changelog_collector.go#L41"},"plugin_name and subtask_name"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"plugin_name: Represents the plugin's name, such as 'jira' for the Jira plugin."),(0,l.kt)("li",{parentName:"ul"},"subtask_name: Denotes the subtask's name, like 'collectIssueChangelogs' for the Jira plugin.\"")),(0,l.kt)("p",null,"Example 1: Enable some subtasks that are closed by default"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'ENABLE_SUBTASKS_BY_DEFAULT="jira:collectIssueChangelogs:true,jira:extractIssueChangelogs:true,jira:convertIssueChangelogs:true,tapd:collectBugChangelogs:true,tapd:extractBugChangelogs:true,tapd:convertBugChangelogs:true,zentao:collectBugRepoCommits:true,zentao:extractBugRepoCommits:true,zentao:convertBugRepoCommits:true,zentao:collectStoryRepoCommits:true,zentao:extractStoryRepoCommits:true,zentao:convertStoryRepoCommits:true,zentao:collectTaskRepoCommits:true,zentao:extractTaskRepoCommits:true,zentao:convertTaskRepoCommits:true"\n')),(0,l.kt)("p",null,"Example 2: Close some subtasks that are executed by default"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'ENABLE_SUBTASKS_BY_DEFAULT="github_graphql:Collect Job Runs:false,github_graphql:Extract Job Runs:false,github_graphql:Convert Job Runs:false"\n')),(0,l.kt)("h3",{id:"github_graphql_job_"},"GITHUB_GRAPHQL_JOB","_","..."),(0,l.kt)("p",null,"This set of environment variables is used to configure and finetune the behavior of the GitHub GraphQL Job Runs collection process."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Environment Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GITHUB_GRAPHQL_JOB_COLLECTION_MODE"),(0,l.kt)("td",{parentName:"tr",align:null},"Specifies the mode of job collection. Possible values are ",(0,l.kt)("inlineCode",{parentName:"td"},"BATCHING")," and ",(0,l.kt)("inlineCode",{parentName:"td"},"PAGINATING")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"BATCHING"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GITHUB_GRAPHQL_JOB_BATCHING_INPUT_STEP"),(0,l.kt)("td",{parentName:"tr",align:null},"Defines the step size for batching mode."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"10"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GITHUB_GRAPHQL_JOB_BATCHING_PAGE_SIZE"),(0,l.kt)("td",{parentName:"tr",align:null},"Defines the limit of jobs to collect in a batch for each run."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"20"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"GITHUB_GRAPHQL_JOB_PAGINATING_PAGE_SIZE"),(0,l.kt)("td",{parentName:"tr",align:null},"Defines the page size for paginating mode."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"50"))))),(0,l.kt)("h4",{id:"when-to-use"},"When to Use"),(0,l.kt)("p",null,"These environment variables are particularly useful when dealing with large repositories that have a significant number of job runs. By adjusting these settings, you can optimize the data collection process to better suit your specific needs and infrastructure capabilities. Also this can help to avoid timeouts on the github GraphQL API with too large requests."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Use ",(0,l.kt)("inlineCode",{parentName:"li"},"BATCHING")," for ",(0,l.kt)("inlineCode",{parentName:"li"},"GITHUB_GRAPHQL_JOB_COLLECTION_MODE")," when your workflow runs typically have less than 20 jobs and you want to minimize the number of API calls to GitHub.",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Adjust ",(0,l.kt)("inlineCode",{parentName:"li"},"GITHUB_GRAPHQL_JOB_BATCHING_INPUT_STEP")," and ",(0,l.kt)("inlineCode",{parentName:"li"},"GITHUB_GRAPHQL_JOB_BATCHING_PAGE_SIZE")," to control how many jobs are collected in each batch. ",(0,l.kt)("strong",{parentName:"li"},"NOTE:")," Increasing these values can lead to timeouts if the requests become too large."))),(0,l.kt)("li",{parentName:"ul"},"Use ",(0,l.kt)("inlineCode",{parentName:"li"},"PAGINATING")," for ",(0,l.kt)("inlineCode",{parentName:"li"},"GITHUB_GRAPHQL_JOB_COLLECTION_MODE")," when your workflow runs have a large number of jobs (e.g., more than 50). This mode will only query 1 Workflow run at a time and paginate through the jobs, reducing the risk of timeouts.",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Adjust ",(0,l.kt)("inlineCode",{parentName:"li"},"GITHUB_GRAPHQL_JOB_PAGINATING_PAGE_SIZE")," to control how many jobs are fetched per page. A smaller page size can help avoid timeouts but may increase the total number of API calls.")))),(0,l.kt)("p",null,"TLDR: ",(0,l.kt)("inlineCode",{parentName:"p"},"BATCHING")," is more efficient for smaller workflows, while ",(0,l.kt)("inlineCode",{parentName:"p"},"PAGINATING")," will guarantee complete collection of jobs for larger workflows."),(0,l.kt)("h2",{id:"how-to-take-effect"},"How to take effect"),(0,l.kt)("p",null,"After setting the environment variable, restart the DevLake service to take effect."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"For Docker Compose, run ",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose down")," and ",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose up -d"),"."),(0,l.kt)("li",{parentName:"ul"},"For Helm, run ",(0,l.kt)("inlineCode",{parentName:"li"},"helm upgrade devlake devlake/devlake --recreate-pods"),".")))}p.isMDXComponent=!0}}]);